"LAMMPS WWW Site"_lws - "LAMMPS Documentation"_ld - "LAMMPS Commands"_lc :c

:link(lws,http://lammps.sandia.gov)
:link(ld,Manual.html)
:link(lc,Section_commands.html#comm)

:line

compute dihedral/local command :h3

[Syntax:]

compute ID group-ID dihedral/local value1 value2 ... :pre

ID, group-ID are documented in "compute"_compute.html command :ulb,l
dihedral/local = style name of this compute command :l
one or more values may be appended :l
value = {phi} :l
  {phi} = tabulate dihedral angles :pre
:ule

[Examples:]

compute 1 all dihedral/local phi :pre

[Description:]

Define a computation that calculates properties of individual dihedral
interactions.  The number of datums generated, aggregated across all
processors, equals the number of angles in the system, modified by the
group parameter as explained below.

The value {phi} is the dihedral angle, as defined in the diagram on
the "dihedral_style"_dihedral_style.html doc page.

The local data stored by this command is generated by looping over all
the atoms owned on a processor and their dihedrals.  A dihedral will
only be included if all 4 atoms in the dihedral are in the specified
compute group.

Note that as atoms migrate from processor to processor, there will be
no consistent ordering of the entries within the local vector or array
from one timestep to the next.  The only consistency that is
guaranteed is that the ordering on a particular timestep will be the
same for local vectors or arrays generated by other compute commands.
For example, dihedral output from the "compute
property/local"_compute_property_local.html command can be combined
with data from this command and output by the "dump local"_dump.html
command in a consistent way.

Here is an example of how to do this:

compute 1 all property/local dtype datom1 datom2 datom3 datom4
compute 2 all dihedral/local phi
dump 1 all local 1000 tmp.dump index c_1\[1\] c_1\[2\] c_1\[3\] c_1\[4\] c_1\[5\] c_2\[1\] :pre

[Output info:]

This compute calculates a local vector or local array depending on the
number of keywords.  The length of the vector or number of rows in the
array is the number of dihedrals.  If a single keyword is specified, a
local vector is produced.  If two or more keywords are specified, a
local array is produced where the number of columns = the number of
keywords.  The vector or array can be accessed by any command that
uses local values from a compute as input.  See "this
section"_Section_howto.html#howto_15 for an overview of LAMMPS output
options.

The output for {phi} will be in degrees.

[Restrictions:] none

[Related commands:]

"dump local"_dump.html, "compute
property/local"_compute_property_local.html

[Default:] none
